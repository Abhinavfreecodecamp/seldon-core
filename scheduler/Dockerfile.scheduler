FROM golang:1.19.3-alpine as builder

WORKDIR /build
COPY . .

# Build the binary
RUN apk add --no-cache make
RUN make -C scheduler -o test-go build-scheduler

# Copy binary
FROM gcr.io/distroless/static:nonroot
COPY --from=builder /build/scheduler/bin/scheduler /bin/scheduler
ENTRYPOINT ["/bin/scheduler"]
